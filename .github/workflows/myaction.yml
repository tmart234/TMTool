name: myActions
on:
  push:
      branches:
        - main

jobs:
  Publish-Pipy:
    runs-on: ubuntu-latest
    steps:
    - name: Set up Python 3.9 üêç
      uses: actions/setup-python@v2
      with:
        python-version: 3.9
    - name: Install pypa/build
      run: |
        python -m pip install build --user
    - name: checkout code
      uses: actions/checkout@v2
    - name: Autobump and Build a binary wheel + tarball
      run: |
        cd ../
        pip install bumpversion tmtool
        VERSION=$(pip show tmtool | grep -oP '(?<=Version: ).*')
        echo "Current Version is: ${VERSION}"
        echo "Bumping..."
        cd $GITHUB_WORKSPACE
        # bumpversion --current-version ${VERSION} patch --allow-dirty pyproject.toml
        # N_VERSION=$(grep -oP '(?<=version = ).*' pyproject.toml)
        # # remove quotes
        # N_VERSION=$(echo "$N_VERSION" | tr -d '"')
        # echo "New Version is: ${N_VERSION}"
        # cd ../
    - name: Publish distribution üì¶ to PyPI
      uses: pypa/gh-action-pypi-publish@master
      with:
        password: ${{ secrets.PYPI_API_TOKEN }}
